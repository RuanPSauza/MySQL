CREATE TABLE usuario (
    usuario_ID INT AUTO_INCREMENT PRIMARY KEY,
    usuario_nome VARCHAR(150) NOT NULL,
    usuario_email VARCHAR(150) NOT NULL,
    usuario_senha VARCHAR(150) NOT NULL,
    usuario_avatar BLOB
);

CREATE TABLE genero (
    genero_ID INT AUTO_INCREMENT PRIMARY KEY,
    genero_nome VARCHAR(150)
);

CREATE TABLE filmes (
    filme_ID INT AUTO_INCREMENT PRIMARY KEY,
    genero_ID INT,
    filme_nome VARCHAR(150),
    filme_diretor VARCHAR(150),
    filme_duracao INT,
    filme_poster BLOB,
    filme_dtlacamento DATE,
    FOREIGN KEY (genero_ID) REFERENCES genero(genero_ID)
);

CREATE TABLE livros (
    livro_ID INT AUTO_INCREMENT PRIMARY KEY,
    genero_ID INT,
    livro_nome VARCHAR(150),
    livro_escritor VARCHAR(150),
    livro_paginas INT,
    livro_capa BLOB,
    livro_dtlacamento DATE,
    FOREIGN KEY (genero_ID) REFERENCES genero(genero_ID)
);

CREATE TABLE filme_genero (
    filmegenero_ID INT AUTO_INCREMENT PRIMARY KEY,
    filme_ID INT,
    FOREIGN KEY (filme_ID) REFERENCES filmes(filme_ID)
);

CREATE TABLE livro_genero (
    livrogenero_ID INT AUTO_INCREMENT PRIMARY KEY,
    livro_ID INT,
    FOREIGN KEY (livro_ID) REFERENCES livros(livro_ID)
);

CREATE TABLE midia (
    midia_ID INT AUTO_INCREMENT PRIMARY KEY,
    filme_ID INT,
    livro_ID INT,
    FOREIGN KEY (filme_ID) REFERENCES filmes(filme_ID),
    FOREIGN KEY (livro_ID) REFERENCES livros(livro_ID)
);

CREATE TABLE lista_personalizadas (
    lpz_ID INT AUTO_INCREMENT PRIMARY KEY,
    usuario_ID INT,
    lpz_nome VARCHAR(150) NOT NULL,
    lpz_descricao VARCHAR(150),
    lpz_dtcriacao DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    lpz_avatar BLOB,
    FOREIGN KEY (usuario_ID) REFERENCES usuario(usuario_ID)
);

CREATE TABLE itens_da_lista (
    idl_ID INT AUTO_INCREMENT PRIMARY KEY,
    usuario_ID INT,
    lpz_ID INT,
    midia_ID INT,
    idl_nome VARCHAR(150),
    idl_avatar BLOB,
    idl_descricao VARCHAR(150),
    FOREIGN KEY (usuario_ID) REFERENCES usuario(usuario_ID),
    FOREIGN KEY (lpz_ID) REFERENCES lista_personalizadas(lpz_ID),
    FOREIGN KEY (midia_ID) REFERENCES midia(midia_ID)
);

CREATE TABLE avaliacao (
    aval_ID INT AUTO_INCREMENT PRIMARY KEY,
    usuario_ID INT,
    midia_ID INT,
    aval_nota INT NOT NULL,
    aval_texto VARCHAR(150),
    aval_data TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    aval_imagem BLOB,
    FOREIGN KEY (usuario_ID) REFERENCES usuario(usuario_ID),
    FOREIGN KEY (midia_ID) REFERENCES midia(midia_ID)
);

CREATE TABLE comentario (
    come_ID INT AUTO_INCREMENT PRIMARY KEY,
    usuario_ID INT,
    aval_ID INT,
    come_texto VARCHAR(150),
    come_data TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (usuario_ID) REFERENCES usuario(usuario_ID),
    FOREIGN KEY (aval_ID) REFERENCES avaliacao(aval_ID)
);
